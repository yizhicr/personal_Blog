# ==================== 应用配置 ====================
spring.application.name=my-blog
server.port=8080

# ==================== 编码配置 ====================
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true
server.servlet.encoding.force-request=true
server.servlet.encoding.force-response=true
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true

# ==================== 数据库配置 ====================
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/my_blog?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:root}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:123456}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# 连接池配置
spring.datasource.hikari.maximum-pool-size=15
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.leak-detection-threshold=30000

# ==================== JPA 配置 ====================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false  # 生产环境关闭SQL显示
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# ==================== Redis 配置 ====================
spring.redis.host=${SPRING_REDIS_HOST:localhost}
spring.redis.port=${SPRING_REDIS_PORT:6379}
spring.redis.timeout=2000ms
spring.redis.lettuce.pool.max-active=8
spring.redis.lettuce.pool.max-idle=8
spring.redis.lettuce.pool.min-idle=0

# ==================== JWT 配置 ====================
jwt.secret=${JWT_SECRET:FC4A83E7C269487854430BA5BF00B131FC4A83E7C269487854430BA5BF00B131}
jwt.expiration=${JWT_EXPIRATION:3600000}  # 1 hour in milliseconds

# ==================== 文件上传配置 ====================
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB
spring.servlet.multipart.enabled=true

# 文件上传路径 - 使用容器卷挂载的目录
file.upload.path=/home/uploads/
file.upload.base-url=http://localhost:8080/uploads/
file.upload.max-size=20971520
file.upload.allowed-types=image/jpeg,image/png,image/gif,application/pdf,text/plain,video/mp4,video/mpeg,video/quicktime,audio/mpeg,audio/wav

# ==================== 日志配置 ====================
logging.level.com.yizhcr.my_blog=WARN  # 生产环境降低日志级别
logging.level.org.springframework.security=INFO
logging.level.org.hibernate=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=ERROR

# ==================== Tomcat配置 ====================
server.tomcat.uri-encoding=UTF-8

# ==================== 安全配置 ====================
# 设置安全头
server.error.include-message=never
server.error.include-binding-errors=never